"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = require("express");
const multer_1 = require("../utils/multer");
const joi_1 = require("../utils/joi");
const validate_1 = require("../middlewares/validate");
const auth_1 = require("../middlewares/auth");
const existing_1 = require("../middlewares/existing");
const file_1 = require("../middlewares/file");
const product_1 = require("../controllers/product");
const router = (0, express_1.Router)();
router.get("/product", auth_1.auth, product_1.readProducts);
router.get("/productAll", auth_1.auth, product_1.readProductsAll);
router.get("/product/:id", auth_1.auth, product_1.readProduct);
router.post("/product", auth_1.auth, auth_1.isAdmin, multer_1.upload.single("image"), (0, validate_1.validate)(joi_1.productSchema), file_1.isFile, file_1.saveFile, product_1.createProduct);
router.put("/product/:id", auth_1.auth, auth_1.isAdmin, (0, existing_1.isExist)("product", false), multer_1.upload.single("image"), file_1.saveFile, product_1.updateProduct);
router.patch("/product/:id/restore", auth_1.auth, auth_1.isAdmin, (0, existing_1.isExist)("product", true), product_1.restoreProduct);
router.delete("/product/:id", auth_1.auth, auth_1.isAdmin, (0, existing_1.isExist)("product", false), product_1.deleteProduct);
exports.default = router;
